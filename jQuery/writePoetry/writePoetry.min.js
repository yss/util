/**
 * 基于jQuery的随机位置展现，我写这个的最初目的是让它展现一首诗歌，所以命名为writePoetry，希望你也能喜欢。
 * @Author yss.nelson@gmail.com | https://github.com/yss
 * @Date 2012/09/16
 * @Update
 */(function(a,b){function c(b,d){if(!(this instanceof c))return new c(b,d);b=a(b);if(!b.length)return;var e={isLoop:!0,scopeValue:64,pos:0,duration:2e3,delay:2e3,easing:"swing"};d=a.extend(d,e),d._width=parseInt(b.outerWidth()/2,10),d._height=parseInt(b.outerHeight()/2,10),d.elems=b.children(),d.ignoreClass&&(d.elems=d.elems.not(d.ignoreClass)),b.css("position","relative"),this.config=d,this.elem=b,this.init()}a.extend(c.prototype,{_getDiff:function(a){return Math.round((a+a)*Math.random())-a},_randomPos:function(a){var b=this.config,c=b._width,d=b._height,e=b.scopeValue,f=this._getDiff(e+c),g=this._getDiff(e+d);return f<0?f-=a.width:g-=a.height,{left:f+c,top:g+d}},run:function(){var b=this,c=this.config,d=c.elems;if(d.length==c.pos){if(!c.isLoop)return;c.pos=0}d.eq(c.pos).animate(c._centerPos[c.pos],c.duration,c.easing,function(){var d=a(this);window.setTimeout(function(){d.animate(a.extend(b._randomPos(c._size[c.pos]),{opacity:0}),c.duration,c.easing),c.pos++,b.run()},c.delay)})},appendData:function(b){b=a(b),b.length&&(this.initData(b),b.appendTo(this.elem))},initData:function(a){a=a||this.config.elems,a.css({position:"absolute",opacity:0}).show(),this._position(a)},_position:function(b){var c=this,d=c.config;a(b).each(function(){var b=a(this),e=b.width(),f=b.height(),g={width:e,height:f};b.css(c._randomPos(g)),d._size.push({width:e,height:f}),d._centerPos.push({left:d._width-e/2,top:d._height-f/2,opacity:1})})},init:function(){var a=this,b=this.config;b._size=[],b._centerPos=[],this.initData(),this.run()}}),a.writePoetry=c})(jQuery);